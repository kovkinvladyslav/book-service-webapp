<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title th:text="${book.name}">Book Details</title>
    <link rel="stylesheet" th:href="@{/css/main.css}">
</head>
<body>
<div th:replace="~{fragments/navbar :: navbar}"></div>

<div class="content-wrapper">
    <a href="/books" class="back-link">‚Üê Back to Book Catalog</a>

    <div class="book-container">
        <h1 th:text="${book.name}"></h1>
        <div class="book-author" th:text="'by ' + ${book.author}"></div>

        <div class="book-price" th:text="'$' + ${#numbers.formatDecimal(book.price, 1, 2)}"></div>

        <div class="book-meta-grid">
            <div class="meta-card"><div class="meta-label">Genre</div><div class="meta-value" th:text="${book.genre}"></div></div>
            <div class="meta-card"><div class="meta-label">Language</div><div class="meta-value" th:text="${book.language}"></div></div>
            <div class="meta-card"><div class="meta-label">Age Group</div><div class="meta-value" th:text="${book.ageGroup}"></div></div>
            <div class="meta-card" th:if="${book.pages}"><div class="meta-label">Pages</div><div class="meta-value" th:text="${book.pages}"></div></div>
        </div>

        <div class="book-section" th:if="${book.description}">
            <h2>Description</h2>
            <p th:text="${book.description}"></p>
        </div>

        <div class="action-buttons">
            <!-- Add to Cart for Client -->
            <form th:action="@{/orders/add}" method="post" sec:authorize="hasRole('CLIENT')" style="display:inline;">
                <input type="hidden" name="name" th:value="${book.name}">
                <button class="btn btn-primary" type="submit">üõí Add to Cart</button>
            </form>

            <!-- Edit/Delete for Employee -->
            <a th:href="@{/books/{name}/edit(name=${book.name})}" class="btn btn-secondary"
               sec:authorize="hasRole('EMPLOYEE')">Edit</a>

            <form th:action="@{/books/{name}/delete(name=${book.name})}" method="post"
                  sec:authorize="hasRole('EMPLOYEE')" style="display:inline;"
                  onsubmit="return confirm('Delete this book?');">
                <button type="submit" class="btn btn-danger">Delete</button>
            </form>
        </div>
    </div>
</div>
</body>
</html>
