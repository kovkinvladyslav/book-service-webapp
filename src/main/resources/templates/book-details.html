<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title th:text="${book.name}">Book Details</title>
    <link rel="stylesheet" th:href="@{/css/main.css}">
</head>
<body>

<!-- Navbar -->
<div th:replace="~{fragments/navbar :: navbar}"></div>

<div class="content-wrapper">

    <a href="/books" class="back-link">‚Üê Back to Book Catalog</a>

    <div class="book-container">
        <div class="book-header">
            <h1 th:text="${book.name}">Book Title</h1>
            <div class="book-author" th:text="'by ' + ${book.author}">by Author Name</div>
        </div>

        <div class="book-price" th:text="'$' + ${#numbers.formatDecimal(book.price, 1, 2)}">$0.00</div>

        <div class="book-meta-grid">
            <div class="meta-card">
                <div class="meta-label">Genre</div>
                <div class="meta-value" th:text="${book.genre}">Genre</div>
            </div>

            <div class="meta-card">
                <div class="meta-label">Language</div>
                <div class="meta-value"
                     th:text="${#strings.capitalizeWords(#strings.toLowerCase(#strings.replace(book.language, '_', ' ')))}">
                    Language
                </div>
            </div>

            <div class="meta-card">
                <div class="meta-label">Age Group</div>
                <div class="meta-value"
                     th:text="${#strings.capitalizeWords(#strings.toLowerCase(#strings.replace(book.ageGroup, '_', ' ')))}">
                    Age Group
                </div>
            </div>

            <div class="meta-card" th:if="${book.pages}">
                <div class="meta-label">Pages</div>
                <div class="meta-value" th:text="${book.pages}">Pages</div>
            </div>

            <div class="meta-card" th:if="${book.publicationDate}">
                <div class="meta-label">Publication Date</div>
                <div class="meta-value" th:text="${#temporals.format(book.publicationDate, 'MMM dd, yyyy')}">Date</div>
            </div>
        </div>

        <div class="book-section" th:if="${book.characteristics}">
            <h2>Characteristics</h2>
            <div class="book-characteristics" th:text="${book.characteristics}">
                Characteristics...
            </div>
        </div>

        <div class="book-section" th:if="${book.description}">
            <h2>Description</h2>
            <div class="book-characteristics" th:text="${book.description}">
                Book description goes here...
            </div>
        </div>

        <div class="action-buttons">
            <!-- Add to Cart - –¥–ª—è CLIENT -->
            <button class="btn btn-primary"
                    sec:authorize="hasRole('CLIENT')">
                üõí Add to Cart
            </button>

            <!-- Edit - ONLY –¥–ª—è EMPLOYEE -->
            <a th:href="@{/books/{name}/edit(name=${book.name})}"
               class="btn btn-secondary"
               sec:authorize="hasRole('EMPLOYEE')">
                Edit Book
            </a>

            <!-- Delete - ONLY –¥–ª—è EMPLOYEE -->
            <form th:action="@{/books/{name}/delete(name=${book.name})}"
                  method="post"
                  style="display: inline;"
                  sec:authorize="hasRole('EMPLOYEE')"
                  onsubmit="return confirm('Are you sure you want to delete this book? This action cannot be undone.');">
                <button type="submit" class="btn btn-danger">Delete Book</button>
            </form>
        </div>
    </div>

</div>

</body>
</html>