<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
</head>
<body>
<nav th:fragment="navbar" class="navbar">
    <a href="/" class="navbar-brand">
        <span>BookStore</span>
    </a>

    <ul class="navbar-menu">
        <!-- Always visible -->
        <li><a href="/books" class="navbar-link">Books</a></li>

        <!-- ADMIN LINKS -->
        <li sec:authorize="hasRole('ADMIN')">
            <a th:href="@{/admin/dashboard}" class="navbar-link">Dashboard</a>
        </li>
        <li sec:authorize="hasRole('ADMIN')">
            <a th:href="@{/admin/employees}" class="navbar-link">Employees</a>
        </li>
        <li sec:authorize="hasRole('ADMIN')">
            <a th:href="@{/admin/orders}" class="navbar-link">All Orders</a>
        </li>
        <li sec:authorize="hasRole('ADMIN')">
            <a href="/books/manage/add" class="navbar-link">Add Book</a>
        </li>

        <!-- EMPLOYEE (but not ADMIN to avoid duplicates) -->
        <li sec:authorize="hasRole('EMPLOYEE') and !hasRole('ADMIN')">
            <a href="/books/manage/add" class="navbar-link">Add Book</a>
        </li>
        <li sec:authorize="hasRole('EMPLOYEE') and !hasRole('ADMIN')">
            <a href="/employee/orders" class="navbar-link">Manage Orders</a>
        </li>
        <li sec:authorize="hasRole('EMPLOYEE') and !hasRole('ADMIN')">
            <a href="/employee/profile" class="navbar-link">Profile</a>
        </li>

        <!-- CLIENT -->
        <li sec:authorize="hasRole('CLIENT')">
            <a href="/orders/cart" class="navbar-link">My Cart</a>
        </li>
        <li sec:authorize="hasRole('CLIENT')">
            <a href="/orders" class="navbar-link">My Orders</a>
        </li>
        <li sec:authorize="hasRole('CLIENT')">
            <a href="/client/profile" class="navbar-link">Profile</a>
        </li>

        <!-- GUEST -->
        <li sec:authorize="!isAuthenticated()">
            <a href="/login" class="navbar-link">Login</a>
        </li>
        <li sec:authorize="!isAuthenticated()">
            <a href="/register" class="navbar-link navbar-link-register">Register</a>
        </li>

        <!-- Authenticated user - logout -->
        <li sec:authorize="isAuthenticated()" class="navbar-user">
            <span class="navbar-email" sec:authentication="name"></span>
            <form th:action="@{/logout}" method="post" style="display:inline;">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                <button type="submit" class="navbar-link navbar-link-logout">Logout</button>
            </form>
        </li>
    </ul>
</nav>
</body>
</html>